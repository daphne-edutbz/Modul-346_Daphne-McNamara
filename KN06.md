# KN06: Skalierung

## A) Installation App (50%)

### Reverse Proxy
Reverse Proxy ist ein Server, der Anfragen von Clients entgegennimmt und sie an einen internen Backend-Service weiterleitet.

In dieser Umgebung:
- .NET Web API läuft intern auf Port 5000
- Nginx hört auf Port 80
- Nginx leitet Anfragen an die Web API weiter

Vorteile eines Reverse Proxys:
- Benutzer greifen nur über Port 80 zu
- Interne Ports bleiben verborgen
- Grundlage für Load Balancer & Skalierung
- Zentrale Stelle für HTTPS, Logging, Security


### Mongo DB Atlas


#### MongoDB Atlas (SaaS)
Für diese Aufgabe wurde MongoDB Atlas als SaaS-Datenbank verwendet.
Dadurch ist kein eigener Datenbankserver notwendig und Wartung, Backups sowie Verfügbarkeit werden vom Anbieter übernommen.

**Einrichtung:**
1. Kostenloses MongoDB-Atlas-Konto erstellt
2. Cluster erstellt (ClusterDaphne)
3. Datenbank-User erstellt (KN06-Daphne)
4. IP-Zugriff erlaubt (temporär 0.0.0.0/0 für Tests)
5. Verbindung über mongodb+srv://...

Die Datenbank wird über die MongoDB Shell (mongosh) aus dem Cloud-Init Script befüllt.

<img width="955" height="511" alt="DBUser" src="https://github.com/user-attachments/assets/f9817739-9e83-4ccc-8b59-ab5d617f8f7c" />

<img width="958" height="509" alt="IPAccessList" src="https://github.com/user-attachments/assets/21f9aa30-8947-496b-8642-9732e7397e75" />



#### Collections

<img width="949" height="481" alt="MongoDBCollections" src="https://github.com/user-attachments/assets/501c437a-ce53-4928-9f87-2d22e6708022" />

Die Datenbank enthält mehrere Collections (z. B. `products`, `users`). Diese wurden über das Cloud-Init Script automatisch importiert.




### Swagger

**Zugriffspunkt:** `http://<Public-IP>/swagger`

<img width="959" height="523" alt="SwaggerUI" src="https://github.com/user-attachments/assets/30d2c629-12b2-4449-ad75-57716de614e7" />



**Endpoint:** `GET /Shop/GetProducts`

<img width="953" height="529" alt="GetProducts" src="https://github.com/user-attachments/assets/f16f5a69-4157-4ca8-948a-ba25470f771a" />




### Cloud-Init

**Welche(r) Teil(e) macht/machen hier überhaupt keinen Sinn in einer produktiven Umgebung?**


1. Passwörter im Klartext
- MongoDB Benutzer & Passwort sind im Cloud-Init sichtbar



2. Benutzer kann alle Befehle ohne Passwort ausführen

`
NOPASSWD:ALL
`




3. Root-Login möglich -> Sicherheitsrisiko

`disable_root: false`



4. Datenbank von überall erreichbar

`IP-Zugriff 0.0.0.0/0`


5. Kein HTTPS
- Kommunikation erfolgt unverschlüsselt


6. Datenbank-Import bei jedem Start
- Führt zu doppelten Daten bei Neustarts


In einer produktiven Umgebung würden:
- Secrets Manager
- eingeschränkte IP-Ranges
- HTTPS
- getrennte Build-/Deploy-Prozesse
verwendet werden




## B) Vertikale Skalierung  (10%)

### Erweiterung der Disk (EBS Volume)
- Disk von 8GB auf 20GB erweitern

#### Vorgehen:
1. Instanz stoppen
2. Elastic Block Store -> Volumes: EBS-Volume auswählen
3. Volume über „Modify Volume“ auf 20 GB vergrössern
4. Instanz wieder starten

Die Änderung ist nicht im laufenden Betrieb möglich -> Instanz MUSS gestoppt werden

#### Vorher:

(Ich habe das Bild von wie es vorher aussah nicht gefunden, aber so sah es aus bevor ich es geändert hab (ohne die Warnung da))

<img width="955" height="478" alt="VolumeVorher" src="https://github.com/user-attachments/assets/f4447d8a-0a4b-4fc3-8c79-8999199cab09" />

#### Nachher:

<img width="756" height="311" alt="VolumeNachher" src="https://github.com/user-attachments/assets/4da481f3-3ddc-4fb1-aa8c-3cc4cd6f3d12" />


### Änderung des Instanztyps
- Web-Instanz wurde von einem kleineren Typ auf t2.medium skaliert, um mehr CPU und RAM zur Verfügung zu haben

#### Vorgehen:
1. Instanz stoppen
2. Instance Type auf t2.medium ändern (Instanz auswählen -> Actions -> Instance Settings -> Change Instance type)
3. Instanz wieder starten

Auch diese Änderung ist nicht im laufenden Betrieb möglich, da CPU und RAM nur im gestoppten Zustand geändert werden können.

#### Vorher

<img width="760" height="388" alt="TypeVorher" src="https://github.com/user-attachments/assets/b3bb391d-8f98-47d2-9ab0-c5eb821af6a6" />

#### Nachher

<img width="950" height="464" alt="TypeNachher" src="https://github.com/user-attachments/assets/df913fe8-872a-4ec1-98c8-f193e27f8a20" />



